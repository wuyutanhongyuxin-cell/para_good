# =============================================================================
# RPI Bot v3.3 配置文件 (Maker优先版) - 保守高胜率配置
# =============================================================================
# 复制此文件为 .env 并填入你的配置
# 本配置优化目标: 高胜率 + 低回撤 + Maker优先

# =============================================================================
# 账号配置 (二选一)
# =============================================================================

# 方式1: 单账号配置
PARADEX_L2_PRIVATE_KEY=0x你的L2私钥
PARADEX_L2_ADDRESS=0x你的L2地址

# 方式2: 多账号配置 (格式: 私钥1,地址1;私钥2,地址2;...)
# PARADEX_ACCOUNTS=0x私钥1,0x地址1;0x私钥2,0x地址2;0x私钥3,0x地址3

# =============================================================================
# 交易配置
# =============================================================================

# 交易市场
MARKET=BTC-USD-PERP

# 每笔交易大小 (BTC) - 小仓位降低单笔风险
TRADE_SIZE=0.001

# 交易周期间隔 (秒) - 不要太频繁，等待好机会
TRADE_INTERVAL=15

# 环境: prod (主网) 或 testnet (测试网)
PARADEX_ENVIRONMENT=prod

# =============================================================================
# 限速设置
# =============================================================================

# 每秒最大交易数
LIMITS_PER_SECOND=2

# 每分钟最大交易数
LIMITS_PER_MINUTE=30

# 每小时最大交易数
LIMITS_PER_HOUR=300

# 每天最大交易数
LIMITS_PER_DAY=1000

# =============================================================================
# 基础风控参数 (保守配置)
# =============================================================================

# 最大允许价差百分比 - 严格限制，只在窄点差时交易
MAX_SPREAD_PCT=0.015

# 止损百分比 (静态)
STOP_LOSS_PCT=0.008

# 风险收益比 - 止盈 = 止损 * 此值 (至少1.5倍)
RISK_REWARD_RATIO=1.8

# 等待止盈/止损最长时间 (秒) - 给足够时间
MAX_WAIT_SECONDS=60

# 检查价格间隔 (秒) - 快速响应
CHECK_INTERVAL=0.3

# 平仓模式: limit = 限价单(Maker优先)
EXIT_ORDER_TYPE=limit

# =============================================================================
# 双向交易配置
# =============================================================================

# 是否启用做空交易 - 开启可双向获利
ENABLE_SHORT=true

# =============================================================================
# 波动率过滤 (严格)
# =============================================================================

# 是否启用波动率过滤
VOLATILITY_FILTER=true

# 最大允许波动率百分比 - 避免高波动行情
MAX_VOLATILITY_PCT=0.04

# 波动率检测窗口 (秒)
VOLATILITY_WINDOW=8

# =============================================================================
# 入场模式与方向信号 (严格)
# =============================================================================

# 入场模式: trend = 趋势跟随 (最稳定)
ENTRY_MODE=trend

# 趋势过滤
TREND_FILTER=true

# 订单簿不平衡度阈值 - 高阈值减少假信号
DIRECTION_SIGNAL_THRESHOLD=0.50

# =============================================================================
# 动态止损 (基于spread)
# =============================================================================

# 是否启用动态止损
DYNAMIC_STOP_LOSS=true

# 止损倍数 - 止损 = spread × 此值 (稍大避免被扫)
STOP_LOSS_MULTIPLIER=2.5

# 动态止损范围限制
DYNAMIC_STOP_LOSS_MIN=0.006
DYNAMIC_STOP_LOSS_MAX=0.018

# =============================================================================
# 追踪止损 (快速保本)
# =============================================================================

# 是否启用追踪止损
TRAILING_STOP_ENABLED=true

# 保本激活阈值 - 盈利达50%目标时移至保本价
BREAKEVEN_ACTIVATION=0.5

# 追踪激活阈值 - 盈利达70%目标时开始追踪
TRAILING_STOP_ACTIVATION=0.7

# 追踪回调百分比 - 从最高盈利回调30%时止损
TRAILING_STOP_CALLBACK=0.30

# =============================================================================
# 智能持仓延长
# =============================================================================

# 是否启用智能持仓
SMART_HOLD_ENABLED=true

# 持仓延长时间 (秒)
HOLD_EXTENSION_SECONDS=15

# 提前退出停滞阈值 - 价格变化小于此值视为停滞
EARLY_EXIT_STAGNATION_THRESHOLD=0.04

# =============================================================================
# RSI信号过滤 (严格)
# =============================================================================

# 是否启用RSI过滤
RSI_FILTER_ENABLED=true

# RSI计算周期
RSI_PERIOD=14

# RSI趋势阈值 - 做多要求RSI>55，做空要求RSI<45 (更严格)
RSI_TREND_THRESHOLD=55

# RSI超买阈值 - 均值回归模式
RSI_OVERBOUGHT=65

# RSI超卖阈值 - 均值回归模式
RSI_OVERSOLD=35

# =============================================================================
# 时段过滤 (UTC时间)
# =============================================================================

# 是否启用时段过滤
TIME_FILTER_ENABLED=true

# 最佳交易时段 (UTC) - 欧美主要交易时段
OPTIMAL_HOURS_START=9
OPTIMAL_HOURS_END=20

# 周末仓位乘数 - 周末缩小仓位
WEEKEND_MULTIPLIER=0.30

# =============================================================================
# Kelly准则仓位管理 (保守)
# =============================================================================

# 是否启用Kelly准则
KELLY_ENABLED=true

# Kelly系数 - 只用建议仓位的8%
KELLY_FRACTION=0.08

# 账户余额最大仓位占比硬上限
MAX_POSITION_PCT=0.20

# =============================================================================
# 仓位平滑
# =============================================================================

# 是否启用仓位平滑
POSITION_SMOOTHING_ENABLED=true

# 单次最大加仓比例
MAX_POSITION_INCREASE_PCT=0.20

# =============================================================================
# 回撤控制 (严格)
# =============================================================================

# 是否启用回撤控制
DRAWDOWN_CONTROL=true

# 单日最大亏损百分比 - 达到后停止当日交易
MAX_DAILY_LOSS_PCT=0.015

# 总最大亏损百分比 - 达到后停止交易
MAX_TOTAL_LOSS_PCT=0.04

# =============================================================================
# 其他配置
# =============================================================================

# Client ID 格式
CLIENT_ID_FORMAT=rpi

# =============================================================================
# v3.2 方向一致性与动量过滤 (必须开启)
# =============================================================================

# 方向趋势确认 - 订单簿方向需要与微趋势一致
DIRECTION_TREND_CONFIRM=true

# 动量过滤窗口大小
PRICE_MOMENTUM_WINDOW=8

# 最小动量斜率阈值 - 要求有明确方向
PRICE_MOMENTUM_MIN_SLOPE=0.001

# =============================================================================
# v3.3 Maker优先配置 (核心盈利点)
# =============================================================================
# 目标: 90%以上成交为Maker，最大化降低点差损耗

# ----- 入场设置 -----

# 入场订单类型: limit = 限价单(Maker优先)
ENTRY_ORDER_TYPE=limit

# 入场启用POST_ONLY模式 - 确保100% Maker
ENTRY_POST_ONLY=true

# 入场价格偏移 (tick数) - 0表示挂在best_bid/ask
ENTRY_PRICE_OFFSET_TICKS=0

# 入场限价单超时时间 (秒) - 给足够时间成交
ENTRY_ORDER_TIMEOUT_SECONDS=5.0

# 入场最大重挂次数 - 多次尝试增加成交率
ENTRY_REQUOTE_MAX=3

# 市价单入场点差限制 - 只有极窄点差才允许Taker
MARKET_SPREAD_LIMIT_PCT=0.004

# ----- 平仓设置 -----

# 平仓启用POST_ONLY模式
EXIT_POST_ONLY=true

# 平仓价格偏移
EXIT_PRICE_OFFSET_TICKS=0

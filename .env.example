# =============================================================================
# RPI Bot v3.3 配置文件 (Maker优先版)
# =============================================================================
# 复制此文件为 .env 并填入你的配置

# =============================================================================
# 账号配置 (二选一)
# =============================================================================

# 方式1: 单账号配置
PARADEX_L2_PRIVATE_KEY=0x你的L2私钥
PARADEX_L2_ADDRESS=0x你的L2地址

# 方式2: 多账号配置 (格式: 私钥1,地址1;私钥2,地址2;...)
# PARADEX_ACCOUNTS=0x私钥1,0x地址1;0x私钥2,0x地址2;0x私钥3,0x地址3

# =============================================================================
# 交易配置
# =============================================================================

# 交易市场
MARKET=BTC-USD-PERP

# 每笔交易大小 (BTC)
TRADE_SIZE=0.0015

# 交易周期间隔 (秒)
TRADE_INTERVAL=9

# 环境: prod (主网) 或 testnet (测试网)
PARADEX_ENVIRONMENT=prod

# =============================================================================
# 限速设置
# =============================================================================

# 每秒最大交易数
LIMITS_PER_SECOND=2

# 每分钟最大交易数
LIMITS_PER_MINUTE=30

# 每小时最大交易数
LIMITS_PER_HOUR=300

# 每天最大交易数
LIMITS_PER_DAY=1000

# =============================================================================
# 基础风控参数
# =============================================================================

# 最大允许价差百分比 - 超过此值跳过交易
MAX_SPREAD_PCT=0.02

# 止损百分比
STOP_LOSS_PCT=0.012

# 风险收益比 - 止盈 = 止损 * 此值
RISK_REWARD_RATIO=1.4

# 等待止盈/止损最长时间 (秒)
MAX_WAIT_SECONDS=45

# 检查价格间隔 (秒)
CHECK_INTERVAL=0.4

# 平仓模式: market = 市价单, limit = 限价单(POST_ONLY)
EXIT_ORDER_TYPE=limit

# =============================================================================
# 双向交易配置 (v3.1新增)
# =============================================================================

# 是否启用做空交易
ENABLE_SHORT=true

# =============================================================================
# 波动率过滤
# =============================================================================

# 是否启用波动率过滤
VOLATILITY_FILTER=true

# 最大允许波动率百分比
MAX_VOLATILITY_PCT=0.06

# 波动率检测窗口 (秒)
VOLATILITY_WINDOW=5

# =============================================================================
# 入场模式与方向信号
# =============================================================================

# 入场模式: trend = 趋势跟随, mean_reversion = 均值回归, hybrid = 混合
ENTRY_MODE=trend

# 趋势过滤
TREND_FILTER=true

# 订单簿不平衡度阈值 - |imbalance| > 此值才入场
DIRECTION_SIGNAL_THRESHOLD=0.45

# =============================================================================
# 动态止损
# =============================================================================

# 是否启用动态止损 - 基于spread自动计算止损位
DYNAMIC_STOP_LOSS=true

# 止损倍数 - 止损 = spread × 此值
STOP_LOSS_MULTIPLIER=2.0

# 动态止损范围限制
DYNAMIC_STOP_LOSS_MIN=0.008
DYNAMIC_STOP_LOSS_MAX=0.03

# =============================================================================
# 追踪止损 (v3.0新增)
# =============================================================================

# 是否启用追踪止损
TRAILING_STOP_ENABLED=true

# 保本激活阈值 - 盈利达到止盈目标的此比例时，止损移至入场价
BREAKEVEN_ACTIVATION=0.6

# 追踪激活阈值 - 盈利达到止盈目标的此比例时，开始追踪
TRAILING_STOP_ACTIVATION=0.8

# 追踪回调百分比 - 从最高盈利回调此比例时触发止损
TRAILING_STOP_CALLBACK=0.35

# =============================================================================
# 智能持仓延长 (v3.0新增)
# =============================================================================

# 是否启用智能持仓
SMART_HOLD_ENABLED=true

# 持仓延长时间 (秒)
HOLD_EXTENSION_SECONDS=10

# 提前退出停滞阈值 - 价格变化小于此值视为停滞
EARLY_EXIT_STAGNATION_THRESHOLD=0.06

# =============================================================================
# RSI信号过滤 (v3.0新增)
# =============================================================================

# 是否启用RSI过滤
RSI_FILTER_ENABLED=true

# RSI计算周期
RSI_PERIOD=14

# RSI趋势阈值 - 做多要求RSI>此值，做空要求RSI<此值
RSI_TREND_THRESHOLD=52

# RSI超买阈值 - 均值回归模式下做空信号
RSI_OVERBOUGHT=70

# RSI超卖阈值 - 均值回归模式下做多信号
RSI_OVERSOLD=30

# =============================================================================
# 时段过滤 (UTC时间)
# =============================================================================

# 是否启用时段过滤
TIME_FILTER_ENABLED=true

# 最佳交易时段 (UTC)
OPTIMAL_HOURS_START=8
OPTIMAL_HOURS_END=21

# 周末仓位乘数
WEEKEND_MULTIPLIER=0.35

# =============================================================================
# Kelly准则仓位管理
# =============================================================================

# 是否启用Kelly准则
KELLY_ENABLED=true

# Kelly系数 - 实际仓位 = Kelly建议仓位 * 此值
KELLY_FRACTION=0.10

# 账户余额最大仓位占比硬上限 - 仓位占用价值不能超过 balance * 此值
MAX_POSITION_PCT=0.30

# =============================================================================
# 仓位平滑 (v3.0新增)
# =============================================================================

# 是否启用仓位平滑
POSITION_SMOOTHING_ENABLED=true

# 单次最大加仓比例
MAX_POSITION_INCREASE_PCT=0.25

# =============================================================================
# 回撤控制
# =============================================================================

# 是否启用回撤控制
DRAWDOWN_CONTROL=true

# 单日最大亏损百分比
MAX_DAILY_LOSS_PCT=0.02

# 总最大亏损百分比
MAX_TOTAL_LOSS_PCT=0.06

# =============================================================================
# 其他配置
# =============================================================================

# Client ID 格式
CLIENT_ID_FORMAT=timestamp

# =============================================================================
# v3.2 新增参数
# =============================================================================

# 方向趋势确认 - 订单簿方向需要与微趋势一致
DIRECTION_TREND_CONFIRM=true

# 动量过滤窗口大小 (用于计算线性回归斜率)
PRICE_MOMENTUM_WINDOW=6

# 最小动量斜率阈值 (百分比，0表示只要方向正确即可)
PRICE_MOMENTUM_MIN_SLOPE=0.0

# =============================================================================
# v3.3 Maker优先配置 (新增)
# =============================================================================
# 目标: 80%以上成交为Maker，显著降低点差损耗

# ----- 入场设置 -----

# 入场订单类型: limit = 限价单(Maker优先), market = 市价单(Taker)
ENTRY_ORDER_TYPE=limit

# 入场是否启用POST_ONLY模式 (true = 确保Maker, 被吃单会拒绝)
ENTRY_POST_ONLY=true

# 入场价格偏移 (tick数, 0 = 挂在best_bid/ask, 正数 = 更激进靠近对手价)
# 做多时: 挂单价 = best_bid + offset * tick_size
# 做空时: 挂单价 = best_ask - offset * tick_size
ENTRY_PRICE_OFFSET_TICKS=0

# 入场限价单超时时间 (秒) - 超时自动撤单
ENTRY_ORDER_TIMEOUT_SECONDS=3.0

# 入场最大重挂次数 - 撤单后最多重新挂单次数
ENTRY_REQUOTE_MAX=2

# 市价单入场点差限制 (百分比) - 限价单失败时，仅当spread<=此值才允许Taker
# 0.006% 约等于 6 美元 @ BTC=$100,000
MARKET_SPREAD_LIMIT_PCT=0.006

# ----- 平仓设置 -----

# 平仓是否启用POST_ONLY模式 (true = 确保Maker)
EXIT_POST_ONLY=true

# 平仓价格偏移 (tick数)
# 做多平仓(卖出): 挂单价 = best_ask + offset * tick_size
# 做空平仓(买入): 挂单价 = best_bid - offset * tick_size
EXIT_PRICE_OFFSET_TICKS=0
